var md5 = require('MD5')
	, mysql = require('mysql')
	, MobileLondonDB = 'nodejs_mysql_test'
	, ML_User = 'ML_Users'
	, client = mysql.createClient({
		user: 'root',
		password: 'manutd',
	})
	, rs = require('RandomString');
	
module.exports.login = function (req, res) {
	var userEmail, userPass, md5Pass;
	userEmail = req.body.email;
	md5Pass =  md5(req.body.password)
	client.query('USE ' + MobileLondonDB);
	var statement = 'SELECT * FROM ' + ML_User + ' WHERE userEmail = \'' + userEmail + '\' AND userPass = \'' + md5Pass + '\'';
	client.query(statement,
		function selectCb(err, results) {
			if (err) { throw err; }
			if(results[0] != undefined) {
				req.session.user = userEmail;
				res.redirect('/');
			} else {
			}
		}
	);
};
module.exports.logout = function (req, res) {
	req.session.user = ''
	res.render('user/logout', {
		title: 'Logout'
	});
};